{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/img/error-icon.png","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios from \"axios\";\n\nconst PIXABAY_API_URL = 'https://pixabay.com/api/';\n\nexport default class PixabayAPI {    \n    #httpClient;\n    constructor(apiKey) {\n        this.#httpClient = axios.create({\n            baseURL: PIXABAY_API_URL,\n            params: {\n                key: apiKey\n            }    \n        });\n    }\n\n    searchImages(urlParams) {\n        return this.#fetch('', urlParams);\n    }\n\n    // searchVideos(urlParams) {\n    //     return this.#fetch('videos/', urlParams);\n    // }\n\n    async #fetch(resourcePath, urlParams) {\n        const response = await this.#httpClient.get(resourcePath, { params: urlParams });\n        return response.data;\n    }\n}","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAENSURBVHgBrZVhDoIwDIUrgfDXm+hRvBFwEr0BXsXjsJnMFVkYsvUV4SWL6Nr3MWgrUUbW2sYY6zSLY3M+Zc7cOWr9evqvL5J18av1OVRVVUdI4c6HwTxIKY5FJ/nbXA3ZYw4hR5hnIZK5MeaKDFMxC8jX3PapRPTi5lJOQWzPewHQpgz49xxkPrmcKwJyEGQe55UEVNdV64P5cmwm1tSEHe+hfAj4hUwAlTmrIKWKglzqGkl1gmg2hVmjnj0QEJuHxxK/EwiRqkGqFqmE433YaJpSFBttDnrfUxACSsWw1+LmJMhWrcyDjoBkzY+AQPM9EMl81QdhLJxOrvGfZ1L96bvblvExaj4JXtJj+QAn5UUxjHYd+gAAAABJRU5ErkJggg==\"","'use strict';\n\nexport default function renderGallery(images){\n    return images.map(img => createGalleryItemMarkup(img)).join(\"\");\n}\n\nfunction createGalleryItemMarkup({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) {\n    let galleryItemMarkup = `<li class=\"gallery-item\">\n                <a class=\"gallery-image-link\" href=\"${largeImageURL}\">\n                    <img \n                        class=\"gallery-image\" \n                        src=\"${webformatURL}\" \n                        alt=\"${tags}\" \n                    />\n                </a>\n                <ul class=\"gallery-item-stats\">`;\n    \n    for (const [key, value] of Object.entries({ likes, views, comments, downloads })) {\n        galleryItemMarkup += `<li class=\"gallery-item-stats-item\">\n                                <p class=\"gallery-item-stats-label\">${key}</p>\n                                <p class=\"gallery-item-stats-value\">${value}</p>\n                              </li>`;\n    }\n    \n    return galleryItemMarkup += '</ul></li>';\n}\n","'use strict';\n\nimport PixabayAPI from './js/pixabay-api.js';\nimport iziToast from 'izitoast';\nimport errorIcon from '/img/error-icon.png';\nimport renderGallery from './js/render-functions.js';\nimport SimpleLightbox from 'simplelightbox';\n\nconst PIXABAY_API_KEY = '25546966-f3ef2260a4c78c9f4c7cc9e45';\nconst SEARCH_IMAGES_REQUEST_OPTIONS = {\n    'image_type': 'photo',\n    'orientation': 'horizontal',\n    'safesearch': true\n};\nconst PER_PAGE = 15;\nconst FIRST_PAGE = 1;\n\nconst pixabayApi = new PixabayAPI(PIXABAY_API_KEY);\nconst gallerySlider = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  captionsPosition: 'bottom',\n});\n\nconst searchForm = document.querySelector('#search-form');\nconst galleryContainer = document.querySelector('.gallery');\nconst loaderElement = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\n\nlet paginatonParams = {\n    'page': FIRST_PAGE,\n    'per_page': PER_PAGE\n}\n\n// the last search query text \nlet searchQueryText;\nlet totalPages = null;\n\nfunction prepareNewSearch(newSearchQueryText) {\n    galleryContainer.innerHTML = '';\n    paginatonParams.page = FIRST_PAGE;\n    searchQueryText = newSearchQueryText;\n    totalPages = null;\n}\n\nfunction scrollGallery() {\n    const galleryItem = document.querySelector('.gallery-item');\n    const rect = galleryItem.getBoundingClientRect();\n    window.scrollBy({ behavior: 'smooth', top: (rect.height + 48) * 2 });\n}\n\nloadMoreBtn.addEventListener('click', (event) => {\n    resolveImageSearching();\n});\n\n\nsearchForm.addEventListener('submit', (event) => {\n    event.preventDefault();\n    const newSearchQueryText = event.currentTarget.searchField.value.trim();\n\n    if (newSearchQueryText === '') {\n        showErrorMessage('You have to write something!');\n        return;\n    }\n\n    // is this the new search query? - prepare for it\n    if (newSearchQueryText !== searchQueryText) {\n        prepareNewSearch(newSearchQueryText);\n    } \n\n    resolveImageSearching();\n});\n\nasync function resolveImageSearching() {\n\n    hideLoadMoreBtn();\n    showLoader();\n\n    let imagesResponse;\n\n    try {\n        imagesResponse = await pixabayApi.searchImages({\n            ...{ 'q': searchQueryText },\n            ...paginatonParams,\n            ...SEARCH_IMAGES_REQUEST_OPTIONS\n        });\n    } catch (error) {\n        showErrorMessage(error.message);\n    } finally {\n        hideLoader();\n        searchForm.reset();\n    }\n    \n    if(imagesResponse.totalHits === 0){\n        showErrorMessage('Sorry, there are no images matching your search query. Please try again!');\n        return;\n    }\n\n    galleryContainer.insertAdjacentHTML('beforeend', renderGallery(imagesResponse.hits));\n    gallerySlider.refresh();\n\n    if (paginatonParams.page !== 1) {\n        scrollGallery();\n    }\n    \n    // null for totalPages means it's the first request with new search query\n    if (totalPages === null) {\n        totalPages = Math.ceil(imagesResponse.totalHits / PER_PAGE);\n    }\n\n    // if next page number will be more then total pages at all - show message and do not show load more button\n    if (++paginatonParams.page > totalPages) {\n        showInfoMessage('We\\'re sorry, but you\\'ve reached the end of search results.');\n    } else {\n        showLoadMoreBtn();\n    }\n}\n\n\nfunction showErrorMessage(msgText) {\n    iziToast.error({\n        title: 'Error',\n        message: msgText,\n        iconUrl: errorIcon,\n        position: 'topRight',\n        titleColor: '#FFF',\n        messageColor: '#FFF',\n        backgroundColor: '#EF4040',\n        theme: 'dark',\n        progressBar: false,\n        close: false,\n    });\n}\n\nfunction showInfoMessage(msgText){\n    iziToast.info({\n        title: 'Info',\n        message: msgText,\n        position: 'topRight',\n        titleColor: '#FFF',\n        messageColor: '#FFF',\n        theme: 'dark',\n        progressBar: false,\n        close: false,\n    });\n}\n\nfunction showLoader() {\n    loaderElement.classList.remove('hidden');\n}\n\nfunction hideLoader() {\n    loaderElement.classList.add('hidden');\n}\n\nfunction showLoadMoreBtn() {\n    loadMoreBtn.classList.remove('hidden');\n}\n\nfunction hideLoadMoreBtn() {\n    loadMoreBtn.classList.add('hidden');\n}"],"names":["PIXABAY_API_URL","PixabayAPI","apiKey","__privateAdd","_fetch","_httpClient","__privateSet","axios","urlParams","__privateMethod","fetch_fn","resourcePath","__privateGet","errorIcon","renderGallery","images","img","createGalleryItemMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","galleryItemMarkup","key","value","PIXABAY_API_KEY","SEARCH_IMAGES_REQUEST_OPTIONS","PER_PAGE","FIRST_PAGE","pixabayApi","gallerySlider","SimpleLightbox","searchForm","galleryContainer","loaderElement","loadMoreBtn","paginatonParams","searchQueryText","totalPages","prepareNewSearch","newSearchQueryText","scrollGallery","rect","event","resolveImageSearching","showErrorMessage","hideLoadMoreBtn","showLoader","imagesResponse","error","hideLoader","showInfoMessage","showLoadMoreBtn","msgText","iziToast"],"mappings":"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"}